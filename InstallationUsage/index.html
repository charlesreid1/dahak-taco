



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://dahak-metagenomics.github.io/dahak-taco/InstallationUsage/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.2">
    
    
      
        <title>Installation and Usage - dahak-taco</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#installation-and-usage" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://dahak-metagenomics.github.io/dahak-taco" title="dahak-taco" class="md-header-nav__button md-logo">
          
            <i class="md-icon">group_work</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                dahak-taco
              </span>
              <span class="md-header-nav__topic">
                Installation and Usage
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/dahak-metagenomics/dahak-taco" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      dahak-taco
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">group_work</i>
      
    </span>
    dahak-taco
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/dahak-metagenomics/dahak-taco" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      dahak-taco
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Index" class="md-nav__link">
      Index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Installation and Usage
      </label>
    
    <a href="./" title="Installation and Usage" class="md-nav__link md-nav__link--active">
      Installation and Usage
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-instructions" title="Installation Instructions" class="md-nav__link">
    Installation Instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clone" title="Clone" class="md-nav__link">
    Clone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-and-install" title="Build and Install" class="md-nav__link">
    Build and Install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verbs" title="Verbs" class="md-nav__link">
    Verbs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flags" title="Flags" class="md-nav__link">
    Flags
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules" title="Rules" class="md-nav__link">
    Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-and-singularity" title="Docker and Singularity" class="md-nav__link">
    Docker and Singularity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-repository" title="Workflow Repository" class="md-nav__link">
    Workflow Repository
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-name" title="Workflow Name" class="md-nav__link">
    Workflow Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-configuration-file" title="Workflow Configuration File" class="md-nav__link">
    Workflow Configuration File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-rule-based-workflow-configuration-file" title="Example Rule-Based Workflow Configuration File" class="md-nav__link">
    Example Rule-Based Workflow Configuration File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-file-based-workflow-configuration-file" title="Example File-Based Workflow Configuration File" class="md-nav__link">
    Example File-Based Workflow Configuration File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-parameters-file" title="Workflow Parameters File" class="md-nav__link">
    Workflow Parameters File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-workflow-parameters-file" title="Example Workflow Parameters File" class="md-nav__link">
    Example Workflow Parameters File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-taco" title="Running Taco" class="md-nav__link">
    Running Taco
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-an-example" title="Running an Example" class="md-nav__link">
    Running an Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listing-available-actions" title="Listing Available Actions" class="md-nav__link">
    Listing Available Actions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-workflows" title="Listing Workflows" class="md-nav__link">
    Listing Workflows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-workflow-rules" title="Listing Workflow Rules" class="md-nav__link">
    Listing Workflow Rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Quickstart/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../AWSSetup/" title="AWS Setup for Walkthroughs" class="md-nav__link">
      AWS Setup for Walkthroughs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../SnakemakeRules/" title="Snakemake Rules" class="md-nav__link">
      Snakemake Rules
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Workflows/" title="Creating Workflows" class="md-nav__link">
      Creating Workflows
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Development/" title="Snakemake Development" class="md-nav__link">
      Snakemake Development
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-instructions" title="Installation Instructions" class="md-nav__link">
    Installation Instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clone" title="Clone" class="md-nav__link">
    Clone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-and-install" title="Build and Install" class="md-nav__link">
    Build and Install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verbs" title="Verbs" class="md-nav__link">
    Verbs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flags" title="Flags" class="md-nav__link">
    Flags
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules" title="Rules" class="md-nav__link">
    Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-and-singularity" title="Docker and Singularity" class="md-nav__link">
    Docker and Singularity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-repository" title="Workflow Repository" class="md-nav__link">
    Workflow Repository
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-name" title="Workflow Name" class="md-nav__link">
    Workflow Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-configuration-file" title="Workflow Configuration File" class="md-nav__link">
    Workflow Configuration File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-rule-based-workflow-configuration-file" title="Example Rule-Based Workflow Configuration File" class="md-nav__link">
    Example Rule-Based Workflow Configuration File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-file-based-workflow-configuration-file" title="Example File-Based Workflow Configuration File" class="md-nav__link">
    Example File-Based Workflow Configuration File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-parameters-file" title="Workflow Parameters File" class="md-nav__link">
    Workflow Parameters File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-workflow-parameters-file" title="Example Workflow Parameters File" class="md-nav__link">
    Example Workflow Parameters File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-taco" title="Running Taco" class="md-nav__link">
    Running Taco
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-an-example" title="Running an Example" class="md-nav__link">
    Running an Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listing-available-actions" title="Listing Available Actions" class="md-nav__link">
    Listing Available Actions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-workflows" title="Listing Workflows" class="md-nav__link">
    Listing Workflows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-workflow-rules" title="Listing Workflow Rules" class="md-nav__link">
    Listing Workflow Rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="installation-and-usage">Installation and Usage<a class="headerlink" href="#installation-and-usage" title="Permanent link">&para;</a></h1>
<p><code>taco</code> is a command-line utility that runs Snakemake workflows. 
This document covers how to install and use taco.</p>
<h2 id="installation-instructions">Installation Instructions<a class="headerlink" href="#installation-instructions" title="Permanent link">&para;</a></h2>
<p><code>taco</code> is installed using <code>setup.py</code>, and will be 
installed as a command-line utility on the system.
When we are finished you will be able to run the 
command </p>
<div class="codehilite"><pre><span></span>$ taco --help
</pre></div>


<p>and see a <code>taco</code> help message.</p>
<h3 id="clone">Clone<a class="headerlink" href="#clone" title="Permanent link">&para;</a></h3>
<p>Start by cloning a local copy of the repository:</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/dahak-metagenomics/dahak-taco
</pre></div>


<p>You can specify a particular tag or branch with the 
clone command, or use the default <code>stable</code> branch.</p>
<h3 id="build-and-install">Build and Install<a class="headerlink" href="#build-and-install" title="Permanent link">&para;</a></h3>
<p>The next step is to build and install the <code>taco</code> source code
using <code>setup.py</code>:</p>
<div class="codehilite"><pre><span></span>$ python setup.py build
</pre></div>


<p>If you want to install taco as a system level module, run:</p>
<div class="codehilite"><pre><span></span>$ python setup.py install
</pre></div>


<p>If you want to install it as a user (recommended):</p>
<div class="codehilite"><pre><span></span>$ python setup.py install --user

$ python setup.py install --user --prefix=    # &lt;-- this is required on mac
</pre></div>


<p>This will install the taco command line utility as an 
executable program in the Python <code>bin</code> location. This 
location may or may not be on your path, and varies
depending on your Python environment, but should be in</p>
<div class="codehilite"><pre><span></span>$PYTHONHOME/bin
</pre></div>


<p>This should be on your <code>$PATH</code> for you to be able to 
call <code>taco</code> from the command line.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>The basic idea behind <code>taco</code> is to pass it a verb, and 
modify the interpretation of the verb using command line flags.</p>
<p>The user will defines their Snakemake workflows in a way that 
keeps them general and utilizes user-provided parameters. 
<code>taco</code> then reads these workflows, determines what rules exist
and what rules were specified by the user, and runs the workflows
using the user-provided parameters.</p>
<h3 id="verbs">Verbs<a class="headerlink" href="#verbs" title="Permanent link">&para;</a></h3>
<p>Run the taco command line tool like this:</p>
<div class="codehilite"><pre><span></span>$ ./taco &lt;verb&gt; --arguments
</pre></div>


<p>taco has two main actions:</p>
<ul>
<li>
<p><code>taco ls [&lt;worfklow&gt;]</code> - lists the available workflows, or the available rules in a given workflow</p>
</li>
<li>
<p><code>taco &lt;worfklow&gt;</code> - runs the specified workflow</p>
</li>
</ul>
<p>Each workflow must specify a set of 
workflow configuration variables 
(names of files or Snakemake rules to run)
and workflow parameters (parameters used 
by the workflows themselves). These control
the details of the workflow.</p>
<h2 id="flags">Flags<a class="headerlink" href="#flags" title="Permanent link">&para;</a></h2>
<p>The principal way to modify taco workflows 
is to use external YAML or JSON files.</p>
<p>To specify the configuration file, which 
tells taco which files to create or which
rules to run, use:</p>
<ul>
<li><strong><code>(--config-json | --config-yaml)</code></strong> - flags specifying 
    the path to the JSON or YAML file to use for the 
    workflow configuration.</li>
</ul>
<p>To specify the parameters file, which 
controls the settings and details of 
each workflow step, use:</p>
<ul>
<li><strong><code>(--params-json | --params-yaml)</code></strong> - flags specifying 
    the path to the JSON or YAML file to use for the 
    workflow parameters.</li>
</ul>
<h2 id="rules">Rules<a class="headerlink" href="#rules" title="Permanent link">&para;</a></h2>
<p>Workflows are defined in a folder called <code>rules/</code>.</p>
<p>The <code>rules/</code> directory contains one folder per workflow.</p>
<p>Each workflow directory contains rules in <code>*.rule</code> files
and default parameters in <code>*.settings</code> files, as well as 
a Snakefile that is imported by taco and that should 
in turn include each rule and settings file used by 
that workflow.</p>
<h2 id="docker-and-singularity">Docker and Singularity<a class="headerlink" href="#docker-and-singularity" title="Permanent link">&para;</a></h2>
<p>Most taco workflows utilize singularity to run docker containers
as part of the workflows. Docker containers are usually specified
by URL, but if a biocontainer or Dockerhub image is broken, a local
image must be used. </p>
<p>For this reason, some workflows will include their own
Dockerfiles. This is not recommended and should serve 
only as a temporary fix.</p>
<h2 id="workflow-repository">Workflow Repository<a class="headerlink" href="#workflow-repository" title="Permanent link">&para;</a></h2>
<p>To create a new set of workflows, create a new repository.</p>
<p>You will need a <code>rules/</code> folder, as well as a folder for
configuration files and parameter files.</p>
<p>The taco tool is then run from that directory, and runs
the workflows defined in that directory.</p>
<p>Here is an example repository layout for 
a repository containing two related workflows:</p>
<div class="codehilite"><pre><span></span>taco-my-cool-workflow/

        rules/
            workflowA/
                Snakefile
                purple.rule
                blue.rule
                green.rule
                workflowA.settings

            workflowB/
                Snakefile
                apple.rule
                orange.rule
                banana.rule
                workflowB.settings

        workflow-config/
            config_make_apples.json
            config_make_blue_apples.json
            config_make_bananas.json
            config_make_green_bananas.json

        workflow-params/
            params_lite.json
            params_medium.json
            params_heavy.json

        docker/
            utility_one/
                Dockerfile
            utility_two/
                Dockerfile
            utility_three/
                Dockerfile
</pre></div>


<h2 id="workflow-name">Workflow Name<a class="headerlink" href="#workflow-name" title="Permanent link">&para;</a></h2>
<p>Each workflow is defined by a Snakefile that includes
a set of rules for each step of the workflow
and a dictionary of parameter values. </p>
<p>Each workflow is in its own directory in the 
<a href="https://github.com/dahak-metagenomics/dahak-taco/tree/master/rules"><code>rules/</code></a>
directory of this repository and must have 
a Snakefile.</p>
<p>The user should specify the workflow name as the first
verb on the command line, then pass any flags that modify
the workflow behavior. For example:</p>
<div class="codehilite"><pre><span></span>$ taco read_filtering (--config-json|--config-yaml) (--params-json|--params-yaml)
</pre></div>


<p>This command will run the Snakemake API with the Snakefile found in <code>rules/read_filtering</code> 
(relative to the current directory where <code>taco</code> was run). It uses the target specified by 
the user's workflow configuration file to figure out what rules to run, and runs them using
the parameters in the user's parameters file.</p>
<h2 id="workflow-configuration-file">Workflow Configuration File<a class="headerlink" href="#workflow-configuration-file" title="Permanent link">&para;</a></h2>
<p>The workflow configuration file 
contains a dictionary of configuration values.</p>
<p>The workflow configuration file
must specify a list of workflow targets
assigned to the key <code>workflow_targets</code>.</p>
<p>The value must be a valid Snakemake rule
defined in one of the rule files at <code>rules/&lt;workflow-name&gt;/*.rules</code>.</p>
<p>The form of the workflow configuration file 
for running rules that have no file targets is
to specify the name of the rule:</p>
<p><strong>JSON:</strong></p>
<div class="codehilite"><pre><span></span>{
    &quot;workflow_targets&quot; : &lt;list of Snakemake rules&gt;
}


{
    &quot;workflow_targets&quot; : &lt;list of output file targets&gt;
}
</pre></div>


<p><strong>YAML:</strong></p>
<div class="codehilite"><pre><span></span>workflow_targets:
  - list
  - of 
  - target
  - files

-----------

workflow_targets:
  - list
  - of
  - target
  - rules
</pre></div>


<h3 id="example-rule-based-workflow-configuration-file">Example Rule-Based Workflow Configuration File<a class="headerlink" href="#example-rule-based-workflow-configuration-file" title="Permanent link">&para;</a></h3>
<p>Here is a simple example of a workflow configuration file
for running a rule that has no file targets (pulling containers).
This rule specifies the workflow target by specifying the 
rule name:</p>
<p><strong>JSON:</strong></p>
<div class="codehilite"><pre><span></span>{
    &quot;workflow_targets&quot; : [&quot;pull_biocontainers&quot;]
}
</pre></div>


<p><strong>YAML:</strong></p>
<div class="codehilite"><pre><span></span>workflow_targets:
  - pull_biocontainers
</pre></div>


<h3 id="example-file-based-workflow-configuration-file">Example File-Based Workflow Configuration File<a class="headerlink" href="#example-file-based-workflow-configuration-file" title="Permanent link">&para;</a></h3>
<p>Here is a simple example of a workflow configuration file
that runs rules based on filename targets (in this example,
the output of a trimming process):</p>
<p><strong>JSON:</strong></p>
<div class="codehilite"><pre><span></span>{
    &quot;workflow_targets&quot; : [&quot;XXXXXX_trim5_1.fq.gz&quot;,
                          &quot;XXXXXX_trim5_2.fq.gz&quot;]
}
</pre></div>


<p><strong>YAML:</strong></p>
<div class="codehilite"><pre><span></span>workflow_targets: 
  - XXXXXX_trim5_1.fq.gz
  - XXXXXX_trim5_2.fq.gz
</pre></div>


<h2 id="workflow-parameters-file">Workflow Parameters File<a class="headerlink" href="#workflow-parameters-file" title="Permanent link">&para;</a></h2>
<p>The workflow parameters control various parameters
that are used by the programs and containers run
by the Snakemake rules.</p>
<p>Each workflow defines a set of default parameter values
in a <code>.settings</code> file that lives next to the <code>Snakefile</code>
and <code>*.rule</code> files.</p>
<p>However, the user can set these parameter values in the 
workflow parameters file, and these values set by the user 
will override the default values.</p>
<p>The workflow parameters control how the workflow proceeds.</p>
<p>The workflow configuration controls the starting and ending points.</p>
<p>The form of the workflow parameters JSON file is:</p>
<p><strong>JSON:</strong></p>
<div class="codehilite"><pre><span></span>{
    &#39;&lt;workflow-name&gt;&#39; : {
        &#39;&lt;rule-name&gt;&#39; : {
            &#39;&lt;param-name&gt;&#39; : &lt;param-value&gt;,
            &#39;&lt;param-list&gt;&#39; : [&lt;value1&gt;, ...],
            ...
        }
    }
}
</pre></div>


<p><strong>YAML:</strong></p>
<div class="codehilite"><pre><span></span>my_workflow_name:

  my_rule_name_1:
    my_param_name_1: &quot;my_param_value&quot;
    my_param_name_2: 10

  my_rule_name_2:
    my_param_name_3: &quot;another_param_value&quot;
    my_param_name_4: 100
</pre></div>


<p>Most parameters are listed under the name of the application
that uses it, but some parameters have more generic names because
they are common to multiple tasks.</p>
<h3 id="example-workflow-parameters-file">Example Workflow Parameters File<a class="headerlink" href="#example-workflow-parameters-file" title="Permanent link">&para;</a></h3>
<p>The following example parameters file adjusts the parameters for 
the rule to update biocontainers.</p>
<p>This is a simple parameter file overriding a single parameter,
the version of sourmash being utilized.</p>
<p>This overrides the default biocontainers setting of 
sourmash version <code>2.0.0a3--py36_0</code>, set in 
<code>rules/dahak/biocontainers.settings</code>.</p>
<p><strong>JSON:</strong></p>
<div class="codehilite"><pre><span></span>{
    &quot;biocontainers&quot; : {
        &quot;trimmomatic&quot; : {
            &quot;use_local&quot; : false,
            &quot;quayurl&quot; : &quot;quay.io/biocontainers/trimmomatic&quot;,
            &quot;version&quot; : &quot;0.36--5&quot;
        }
    }
}
</pre></div>


<p><strong>YAML:</strong></p>
<div class="codehilite"><pre><span></span>biocontainers:
  trimmomatic:
    quayurl: &quot;quay.io/biocontainers/trimmomatic&quot;
    version: &#39;0.36--5&quot;
    use_local: false
</pre></div>


<h2 id="running-taco">Running Taco<a class="headerlink" href="#running-taco" title="Permanent link">&para;</a></h2>
<p>To run taco, pass it three arguments on the command line:</p>
<ul>
<li>Name of the workflow</li>
<li>Relative path to workflow configuration file</li>
<li>Relative path to workflow parameters file</li>
</ul>
<p>Both arguments should be the path to a JSON file
(absolute or relative) and exclude the JSON suffix.</p>
<h3 id="running-an-example">Running an Example<a class="headerlink" href="#running-an-example" title="Permanent link">&para;</a></h3>
<p>To run the two JSON files in the example above,
which are contained in the <code>goodies/</code> directory 
and which are the first steps in the taxonomic classification 
workflow, we would run:</p>
<div class="codehilite"><pre><span></span>$ ./taco taxonomic_classification goodies/test-conf.json goodies/test-params.json
</pre></div>


<p>(The <code>.json</code> extension can be included or excluded.)</p>
<p>To do a dry run only, add the <code>-n</code> or <code>--dry-run</code> flag:</p>
<div class="codehilite"><pre><span></span>$ ./taco -n taxonomic_classification goodies/test-conf goodies/test-params
</pre></div>


<p>This will run the <code>pull_biocontainers</code> rule.</p>
<h2 id="listing-available-actions">Listing Available Actions<a class="headerlink" href="#listing-available-actions" title="Permanent link">&para;</a></h2>
<h3 id="listing-workflows">Listing Workflows<a class="headerlink" href="#listing-workflows" title="Permanent link">&para;</a></h3>
<p>You can list available taco workflows
using the <code>taco ls</code> command with no 
additional arguments:</p>
<div class="codehilite"><pre><span></span>$ ./taco ls
</pre></div>


<h3 id="listing-workflow-rules">Listing Workflow Rules<a class="headerlink" href="#listing-workflow-rules" title="Permanent link">&para;</a></h3>
<p>(Not available)</p>
<p>You can list all of the rules available 
for a given workflow by running <code>taco ls &lt;workflow-name&gt;</code>.
For example:</p>
<div class="codehilite"><pre><span></span>$ ./taco ls read_filtering
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Index" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Index
              </span>
            </div>
          </a>
        
        
          <a href="../Quickstart/" title="Quick Start" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Quick Start
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 <a href="http://ivory.idyll.org/lab/">Lab for Data Intensive Biology</a> at UC Davis
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.0cf9b500.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
        <script src="../search/require.js"></script>
      
        <script src="../search/search.js"></script>
      
    
    
      
    
  </body>
</html>